//
//  Filter.cpp
//  TapirLib
//
//  Created by Jimin Jeon on 1/9/14.
//  Copyright (c) 2014 Jimin Jeon. All rights reserved.
//

#include "../include/Filter.h"

namespace Tapir {

    //****** FIR Filter ********
    FilterFIR::FilterFIR(const float * coeff, const int filtOrder, const int maxBufferSize)
    :m_order(filtOrder),
    m_coeff(new float[m_order]),
    m_bufferSize(filtOrder + maxBufferSize),
    m_buffer(new float[m_bufferSize]())
    {
        TapirDSP::copy(coeff, coeff + m_order, m_coeff);
        TapirDSP::vrvrs(m_coeff, m_order);

    };
    void FilterFIR::process(const float * src, float * dest, int length)
    {
        //copy data to buffer
        TapirDSP::copy(src, src + length, m_buffer + m_order - 1);
        float * curBufferPos = m_buffer;
        for(int i=0; i<length; ++i)
        {
            TapirDSP::dotpr(curBufferPos++, m_coeff, dest++, m_order);
        }
        //copy the last elements of source to buffer (for next Filtering)
        TapirDSP::copy(src + length - m_order + 1, src + length, m_buffer);
    };
    void FilterFIR::clearBuffer()
    {
        std::fill(m_buffer, m_buffer + m_bufferSize, 0);
    };
    FilterFIR::~FilterFIR()
    {
        if(m_coeff != nullptr)
        { delete [] m_coeff; m_coeff = nullptr; }
        if(m_buffer != nullptr)
        { delete [] m_buffer; m_buffer = nullptr; }
    };
    
#ifdef __APPLE__
    //****** IIR Filter ********
//    FilterIIR::FilterIIR()
//    : m_coeff(nullptr), m_section(0), m_filtDelay(nullptr), m_filterSetup(nullptr)
//    {};
    FilterIIR::FilterIIR(const float * coeff, const int numSection)
    :m_numSection(numSection),
    m_coeff(new double[m_numSection * 5]),
    m_filtDelay(new float[ 2* m_numSection + 2]),
    m_filterSetup(vDSP_biquad_CreateSetup(m_coeff, m_numSection))
    {
        vDSP_vspdp(coeff, 1, m_coeff, 1, m_numSection * 5);
    };
    void FilterIIR::process(const float * src, float * dest, int length)
    {
        vDSP_biquad(m_filterSetup, m_filtDelay, src, 1, dest, 1, length);
        
        /*************************
        * vDSP_biquad(const struct vDSP_biquad_SetupStruct *__vDSP_Setup, float *__vDSP_Delay, const float *__vDSP_X, vDSP_Stride __vDSP_IX, float *__vDSP_Y, vDSP_Stride __vDSP_IY, vDSP_Length __vDSP_N)

         S, A0, A1, A2, B1, and B2 are determined by Setup.
         S is the number of sections.
         
         X provides the bulk of the input signal.  Delay provides prior state
         data for S biquadratic filters.  The filters are applied to the data in
         turn.  The output of the final filter is stored in Y, and the final
         state data of the filters are stored in Delay.
         
        // Initialize the first row of a matrix x with data from X:
        for (n = 0; n < N; ++n)
            x[0][n ] = X[n*IX];
        
        // Initialize the "past" information, elements -2 and -1, from Delay:
        for (s = 0; s <= S; ++s)
        {
            x[s][-2] = Delay[2*s+0];
            x[s][-1] = Delay[2*s+1];
        }
        
        // Apply each filter:
        for (s = 1; s <= S; ++s)
            for (n = 0; n < N; ++n)
                x[s][n] =
                + A0[s] * x[s-1][n-0]
                + A1[s] * x[s-1][n-1]
                + A2[s] * x[s-1][n-2]
                - B1[s] * x[s  ][n-1]
                - B2[s] * x[s  ][n-2];
        
        // Save the updated state data from the end of each row:
        for (s = 0; s <= S; ++s)
        {
            Delay[2*s+0] = x[s][N-2];
            Delay[2*s+1] = x[s][N-1];
        }
        
        // Store the results of the final filter:
        for (n = 0; n < N; ++n)
            Y[n*IY] = x[S][n];
        *********************************/
        
        
    };
    void FilterIIR::clearBuffer()
    {
        std::fill(m_filtDelay, m_filtDelay + (2 * m_numSection + 2), 0);
    };
    FilterIIR::~FilterIIR()
    {
        if(m_filterSetup != nullptr)
        { vDSP_biquad_DestroySetup(m_filterSetup); }
        if(m_coeff != nullptr)
        { delete [] m_coeff; m_coeff = nullptr; }
        if(m_filtDelay != nullptr)
        { delete [] m_filtDelay; m_filtDelay = nullptr;}
    };

#endif

    //****** Filters For Tapir *******

    
//    const std::vector<std::tr1::function<Filter *(const int)> > FilterCreator::filterCreateFuncs({
//        createHamming19k50,
//        createChevyshev19k150,
//        createChevyshev19k250,
//        createEquiripple19k250
//    });
    Filter * FilterCreator::create(int maxBufSize, Tapir::FilterCreator::FilterType fType)
    {
        switch(fType)
        {
            case(HAMMING_19k_50):
                return createHamming19k50(maxBufSize);
            case(CHEVYSHEV_19k_150):
                return createChevyshev19k150(maxBufSize);
            case(CHEVYSHEV_19k_250):
                return createChevyshev19k250(maxBufSize);
            case(EQUIRIPPLE_19k_250):
                return createEquiripple19k250(maxBufSize);
        }
//        return(filterCreateFuncs[fType](maxBufSize));
    };

    Filter * FilterCreator::createHamming19k50(int maxBufSize)
    {
        int order = 51;
        float coef[] = {
            -0.000974904910325978405274960358894986712,
            0.001061570369449390963470514215316597983,
            -0.000845968749311988327428679657060683894,
            0.000207446002690359727286401048118591461,
            0.000898872800870446886888076587496243519,
            -0.002280760783206247418325451903342582227,
            0.003421613224756182413538452280477031309,
            -0.003573513116002676164723039775594770617,
            0.002059077967269363866609221958015041309,
            0.001306637501988568150768088571567204781,
            -0.005863888601476439227377923657513747457,
            0.010042861492369518569556241516238515032,
            -0.01172573863896613291513126853260473581,
            0.009010891522838104447656881745842838427,
            -0.001159090966887983296593200854829319724,
            -0.01063785830046301041085232697014362202,
            0.023036860284334149256979529241107229609,
            -0.031097860730212163044017259494466998149,
            0.029574426226330587097468338697581202723,
            -0.014609057854509839569079332477485877462,
            -0.014705576307981381434242251771138398908,
            0.055467322703750356061025428289212868549,
            -0.101195096771377376909661904846871038899,
            0.143197100713312597264348369208164513111,
            -0.172738244745205077324001763372507411987,
            0.183375122580046623355087831441778689623,
            -0.172738244745205077324001763372507411987,
            0.143197100713312597264348369208164513111,
            -0.101195096771377376909661904846871038899,
            0.055467322703750356061025428289212868549,
            -0.014705576307981381434242251771138398908,
            -0.014609057854509839569079332477485877462,
            0.029574426226330587097468338697581202723,
            -0.031097860730212163044017259494466998149,
            0.023036860284334149256979529241107229609,
            -0.01063785830046301041085232697014362202,
            -0.001159090966887983296593200854829319724,
            0.009010891522838104447656881745842838427,
            -0.01172573863896613291513126853260473581,
            0.010042861492369518569556241516238515032,
            -0.005863888601476439227377923657513747457,
            0.001306637501988568150768088571567204781,
            0.002059077967269363866609221958015041309,
            -0.003573513116002676164723039775594770617,
            0.003421613224756182413538452280477031309,
            -0.002280760783206247418325451903342582227,
            0.000898872800870446886888076587496243519,
            0.000207446002690359727286401048118591461,
            -0.000845968749311988327428679657060683894,
            0.001061570369449390963470514215316597983,
            -0.000974904910325978405274960358894986712 };
        return (new FilterFIR(coef, order, maxBufSize));
    };
    
    Filter * FilterCreator::createChevyshev19k150(int maxBufSize)
    {
        int order = 151;
        float coef[] = {
            -0.000170763361221076966859483414751252894,
            0.000048668532051131500480636166150461008,
            -0.0000261955214934211652133642239670408  ,
            -0.000013243707086147286762175569185817636,
            0.000065288926320210860271449349045980171,
            -0.000120506385849752134151700866393497336,
            0.000165400498256894221355342566859292219,
            -0.000184842290925514693335912630445250215,
            0.000165628933713292766536848144021121243,
            -0.00010051123237563445501387138225624085 ,
            -0.000008260367747902088960462035904797062,
            0.000146920015936927053461225067820805634,
            -0.000290595922245175510099240989703162086,
            0.000406620306133613637015328245993828205,
            -0.000460582849037835496356502185122394621,
            0.000424244501288752043962476667715577605,
            -0.000283773610156521521354078263499332024,
            0.000046361206292523318575962698595560596,
            0.000256733940756594786712641020898217903,
            -0.000572189812880435780609311713362785667,
            0.000832234148441190601380723634861169558,
            -0.000967195108444755249563207222252003703,
            0.000921020016439220903098350490267876012,
            -0.000666723532392384334900603537477081773,
            0.000218181454793049618744518736157544936,
            0.000365116226007554433088952983155195398,
            -0.000982720160798819216199651016552252258,
            0.001507911273447684651419220536183729564,
            -0.0018108758409995098174333216789477774  ,
            0.001786634898782416816173657103661298606,
            -0.001382307586417309830384425595184438862,
            0.000617551934671743685267841783570474945,
            0.000407444102053972068405024442583339805,
            -0.001520182192576513243234548333759903471,
            0.002501060073480031349657526362761927885,
            -0.003122738800316319195127245933463200345,
            0.003197332017766527176988455849482306803,
            -0.00262244048224748432102115813790987886 ,
            0.001415990416443644109301125411093380535,
            0.000269209946674527956806538542267048797,
            -0.002157239358386056973793110103088110918,
            0.003888451359507538122178837980413845798,
            -0.005082108555634868955752647678991706925,
            0.005412398465177070162879235937225530506,
            -0.004683831166199394803462130454363432364,
            0.00289028145817056027200298018442481407 ,
            -0.000243255965743952392741841772583200054,
            -0.002840566735501755084303265874723365414,
            0.005795407187582688780802531169911162579,
            -0.008000432792228838116410649661247589393,
            0.008897750927383034358353341986003215425,
            -0.008113757904597113448930123524860391626,
            0.005560057850819423788668593999773293035,
            -0.001491332468877336423634938356030943396,
            -0.003496699679047659929664870759324912797,
            0.00853641060335439370854171414748634561 ,
            -0.012619542468443130725508360967523913132,
            0.014773283243206465284447226338215841679,
            -0.014253412930981155040677244016933400417,
            0.010720645538266423621442946512161142891,
            -0.004365898632086721506406767900898557855,
            -0.004043855231304752974319516312107225531,
            0.013215856761217835077526494558242120547,
            -0.021478996531867234481838480064652685542,
            0.027012386287945715224179110691693495028,
            -0.028123531629975807855092995168888592161,
            0.023533560203074798539146783582509669941,
            -0.012622683302630881285733011054617236368,
            -0.004407327811675619023967787057927125716,
            0.026485612347100180585801609822738100775,
            -0.051754299874529889613494759714740212075,
            0.0777742812824586404740756506726029329  ,
            -0.101828333539793008943874497163051273674,
            0.121278532660638066476010976657562423497,
            -0.133924829137936962641930449535720981658,
            0.138310147497649083003778969214181415737,
            -0.133924829137936962641930449535720981658,
            0.121278532660638066476010976657562423497,
            -0.101828333539793008943874497163051273674,
            0.0777742812824586404740756506726029329  ,
            -0.051754299874529889613494759714740212075,
            0.026485612347100180585801609822738100775,
            -0.004407327811675619023967787057927125716,
            -0.012622683302630881285733011054617236368,
            0.023533560203074798539146783582509669941,
            -0.028123531629975807855092995168888592161,
            0.027012386287945715224179110691693495028,
            -0.021478996531867234481838480064652685542,
            0.013215856761217835077526494558242120547,
            -0.004043855231304752974319516312107225531,
            -0.004365898632086721506406767900898557855,
            0.010720645538266423621442946512161142891,
            -0.014253412930981155040677244016933400417,
            0.014773283243206465284447226338215841679,
            -0.012619542468443130725508360967523913132,
            0.00853641060335439370854171414748634561 ,
            -0.003496699679047659929664870759324912797,
            -0.001491332468877336423634938356030943396,
            0.005560057850819423788668593999773293035,
            -0.008113757904597113448930123524860391626,
            0.008897750927383034358353341986003215425,
            -0.008000432792228838116410649661247589393,
            0.005795407187582688780802531169911162579,
            -0.002840566735501755084303265874723365414,
            -0.000243255965743952392741841772583200054,
            0.00289028145817056027200298018442481407 ,
            -0.004683831166199394803462130454363432364,
            0.005412398465177070162879235937225530506,
            -0.005082108555634868955752647678991706925,
            0.003888451359507538122178837980413845798,
            -0.002157239358386056973793110103088110918,
            0.000269209946674527956806538542267048797,
            0.001415990416443644109301125411093380535,
            -0.00262244048224748432102115813790987886 ,
            0.003197332017766527176988455849482306803,
            -0.003122738800316319195127245933463200345,
            0.002501060073480031349657526362761927885,
            -0.001520182192576513243234548333759903471,
            0.000407444102053972068405024442583339805,
            0.000617551934671743685267841783570474945,
            -0.001382307586417309830384425595184438862,
            0.001786634898782416816173657103661298606,
            -0.0018108758409995098174333216789477774  ,
            0.001507911273447684651419220536183729564,
            -0.000982720160798819216199651016552252258,
            0.000365116226007554433088952983155195398,
            0.000218181454793049618744518736157544936,
            -0.000666723532392384334900603537477081773,
            0.000921020016439220903098350490267876012,
            -0.000967195108444755249563207222252003703,
            0.000832234148441190601380723634861169558,
            -0.000572189812880435780609311713362785667,
            0.000256733940756594786712641020898217903,
            0.000046361206292523318575962698595560596,
            -0.000283773610156521521354078263499332024,
            0.000424244501288752043962476667715577605,
            -0.000460582849037835496356502185122394621,
            0.000406620306133613637015328245993828205,
            -0.000290595922245175510099240989703162086,
            0.000146920015936927053461225067820805634,
            -0.000008260367747902088960462035904797062,
            -0.00010051123237563445501387138225624085 ,
            0.000165628933713292766536848144021121243,
            -0.000184842290925514693335912630445250215,
            0.000165400498256894221355342566859292219,
            -0.000120506385849752134151700866393497336,
            0.000065288926320210860271449349045980171,
            -0.000013243707086147286762175569185817636,
            -0.0000261955214934211652133642239670408  ,
            0.000048668532051131500480636166150461008,
            -0.000170763361221076966859483414751252894 };
        return (new FilterFIR(coef, order, maxBufSize));
    };
    Filter * FilterCreator::createChevyshev19k250(int maxBufSize)
    {
        int order = 251;
        float coef[] = {
            0.000135450061907561012958939317130102609,
            -0.000018322460239788132595282338366260433,
            0.000001914174485137727038615079386274509,
            0.000019131083971454911828126085882040286,
            -0.000041049015408569425854019147026363612,
            0.000059008308070323965872656241105076447,
            -0.000068028167296151656430122645069502596,
            0.000064116209784480525423269736684517284,
            -0.000045397517611404454758190080143620548,
            0.000012966839022527635013671588881667418,
            0.000028785854511730010919920083600764826,
            -0.000072546170807492613781704282605033995,
            0.000109179278800662291071255083352298243,
            -0.000129440946180701287786599107398899378,
            0.000126009690458823341236219151006991979,
            -0.000095434744204673249983079952318831829,
            0.00003954909434114758215840848554201159 ,
            0.000034053340593552446644368125738822073,
            -0.000112729639074087917630095923016142478,
            0.000180715773134834168690832090220510509,
            -0.000222031901071524472154536389290058196,
            0.000223875855225321828811252400370790383,
            -0.000179837642227859779899684644632884556,
            0.000092211836657987033714564684139247674,
            0.000027220299951538816726629224640454652,
            -0.000158322051289122627199326687197356023,
            0.000275667582450218916819556502773025386,
            -0.000353151311061978049297971349318459033,
            0.000369365162239951750223349025148422697,
            -0.000312703110865392229066744844701020156,
            0.000185076639727297612581652375141061384,
            -0.000003278367075042088985513660109871736,
            -0.000202590877056878752729765502671455124,
            0.000393667682266056419195660032173123   ,
            -0.000529258201768758609027931694157587117,
            0.000574998211069439771163380736851422625,
            -0.000510687277928748278171822150284242525,
            0.000336129189338528206864448177881854463,
            -0.000073533826131665439018725294317846419,
            -0.00023441338636570594237094888878658594 ,
            0.000530908914193105947905426678090634596,
            -0.000755002350947948605054682591486425736,
            0.000853530736739373414867504408221066114,
            -0.000792779764167927795438794991156328251,
            0.000567450919581423537593756201147243701,
            -0.000204809898205270303353855987360532254,
            -0.000237342652649818336169779131594737009,
            0.000679112213855269483860077617265460503,
            -0.001032309454508825892482537511796181207,
            0.001217351326502314748032040903069628257,
            -0.00118014786248071368128520486351362706 ,
            0.000905549924794708219373540192265181759,
            -0.000424293604470985972424573740013897805,
            -0.00018860304012113592942237461080878802 ,
            0.000824501123670985072884598299225444862,
            -0.001359586233664223904951673382868193585,
            0.001678130157640419931400210806771156058,
            -0.001696349830613690882336053178391921392,
            0.00138212992535105029523467834451366798 ,
            -0.000766269534214117906990859641069846475,
            -0.000057781923620862762739931045574692803,
            0.000946701100638953755607440943009578405,
            -0.001731164307572115876668328304788246896,
            0.002247055976584658165684516006876947358,
            -0.00236844977252140135096092343758300558 ,
            0.002035956043504828436030429372749495087,
            -0.001274392238745837612270972449834971485,
            0.00019533307591905788675942790000306104 ,
            0.001017280443332563332273221767820814421,
            -0.002137086853321259853621949531543577905,
            0.002936216435321596218005479883572661493,
            -0.00323002149638270666040518186434837844 ,
            0.002917119795773251249293434028686533566,
            -0.002006460069946041421123927861458469124,
            0.000624988061444810760400314642026842193,
            0.000997219381413937035890659998926821572,
            -0.002563310760775394138433203039539876045,
            0.003762158653963892842447824804708034208,
            -0.004328048705525381310843524573783724918,
            0.004096469217645492058577083582804334583,
            -0.003044773972227789778782769403164820687,
            0.001308536317418792756586687353603792872,
            0.000831588579942628609333044042983829058,
            -0.002992352130736840830349532183163319132,
            0.004753893821660006013818389192238100804,
            -0.005738329212503927995170371900712780189,
            0.005686742662005745199693684810426930198,
            -0.004519552976411926603628188559014233761,
            0.002367223979584138528198256068435512134,
            0.000437041377760343614441995718777889124,
            -0.003404349894532900100418970623650238849,
            0.005971155134318071981691655736312895897,
            -0.007601564108482269065125702667273799307,
            0.007893112934018432780280960514573962428,
            -0.006666113976735077786828220780535048107,
            0.004018183411830422886723557240884474595,
            -0.000330650086571922740240336846540003535,
            -0.003778468067033815235011839916978715337,
            0.007550636326439000289845182578574167565,
            -0.010218300417461037565836079465952934697,
            0.011150174837247953801844246868313348386,
            -0.009984461773956636657101348930609674426,
            0.006724231460553006974045775478998621111,
            -0.001773997651194974710039953258444711537,
            -0.004094509371967686335580527412503215601,
            0.009847570409712179048677960224722482963,
            -0.014353201892725620317237122947062744061,
            0.016579476697478588015366440799880365375,
            -0.015795553678226860461197844642811105587,
            0.011740573324032742286160413414108916186,
            -0.004728478651082837318220253308709288831,
            -0.00433457888204243687452210664901031123 ,
            0.014030448982566921106718282885594817344,
            -0.0226013348550313485085805353946852847  ,
            0.028193146747981349259370986715111939702,
            -0.029135704365453238967598181829998793546,
            0.024217597188809465019732058976842381526,
            -0.01291201017087072189237773045533685945 ,
            -0.004484621421223531148592122974605445052,
            0.02682729609206457171977078246527526062 ,
            -0.052219995925446939522007738787579000928,
            0.078226882108184084274604686015663901344,
            -0.102170048716351963280501990993798244745,
            0.121472669670416269505075490542367333546,
            -0.133998433664115179642095654344302602112,
            0.138337743263508644586678997256967704743,
            -0.133998433664115179642095654344302602112,
            0.121472669670416269505075490542367333546,
            -0.102170048716351963280501990993798244745,
            0.078226882108184084274604686015663901344,
            -0.052219995925446939522007738787579000928,
            0.02682729609206457171977078246527526062 ,
            -0.004484621421223531148592122974605445052,
            -0.01291201017087072189237773045533685945 ,
            0.024217597188809465019732058976842381526,
            -0.029135704365453238967598181829998793546,
            0.028193146747981349259370986715111939702,
            -0.0226013348550313485085805353946852847  ,
            0.014030448982566921106718282885594817344,
            -0.00433457888204243687452210664901031123 ,
            -0.004728478651082837318220253308709288831,
            0.011740573324032742286160413414108916186,
            -0.015795553678226860461197844642811105587,
            0.016579476697478588015366440799880365375,
            -0.014353201892725620317237122947062744061,
            0.009847570409712179048677960224722482963,
            -0.004094509371967686335580527412503215601,
            -0.001773997651194974710039953258444711537,
            0.006724231460553006974045775478998621111,
            -0.009984461773956636657101348930609674426,
            0.011150174837247953801844246868313348386,
            -0.010218300417461037565836079465952934697,
            0.007550636326439000289845182578574167565,
            -0.003778468067033815235011839916978715337,
            -0.000330650086571922740240336846540003535,
            0.004018183411830422886723557240884474595,
            -0.006666113976735077786828220780535048107,
            0.007893112934018432780280960514573962428,
            -0.007601564108482269065125702667273799307,
            0.005971155134318071981691655736312895897,
            -0.003404349894532900100418970623650238849,
            0.000437041377760343614441995718777889124,
            0.002367223979584138528198256068435512134,
            -0.004519552976411926603628188559014233761,
            0.005686742662005745199693684810426930198,
            -0.005738329212503927995170371900712780189,
            0.004753893821660006013818389192238100804,
            -0.002992352130736840830349532183163319132,
            0.000831588579942628609333044042983829058,
            0.001308536317418792756586687353603792872,
            -0.003044773972227789778782769403164820687,
            0.004096469217645492058577083582804334583,
            -0.004328048705525381310843524573783724918,
            0.003762158653963892842447824804708034208,
            -0.002563310760775394138433203039539876045,
            0.000997219381413937035890659998926821572,
            0.000624988061444810760400314642026842193,
            -0.002006460069946041421123927861458469124,
            0.002917119795773251249293434028686533566,
            -0.00323002149638270666040518186434837844 ,
            0.002936216435321596218005479883572661493,
            -0.002137086853321259853621949531543577905,
            0.001017280443332563332273221767820814421,
            0.00019533307591905788675942790000306104 ,
            -0.001274392238745837612270972449834971485,
            0.002035956043504828436030429372749495087,
            -0.00236844977252140135096092343758300558 ,
            0.002247055976584658165684516006876947358,
            -0.001731164307572115876668328304788246896,
            0.000946701100638953755607440943009578405,
            -0.000057781923620862762739931045574692803,
            -0.000766269534214117906990859641069846475,
            0.00138212992535105029523467834451366798 ,
            -0.001696349830613690882336053178391921392,
            0.001678130157640419931400210806771156058,
            -0.001359586233664223904951673382868193585,
            0.000824501123670985072884598299225444862,
            -0.00018860304012113592942237461080878802 ,
            -0.000424293604470985972424573740013897805,
            0.000905549924794708219373540192265181759,
            -0.00118014786248071368128520486351362706 ,
            0.001217351326502314748032040903069628257,
            -0.001032309454508825892482537511796181207,
            0.000679112213855269483860077617265460503,
            -0.000237342652649818336169779131594737009,
            -0.000204809898205270303353855987360532254,
            0.000567450919581423537593756201147243701,
            -0.000792779764167927795438794991156328251,
            0.000853530736739373414867504408221066114,
            -0.000755002350947948605054682591486425736,
            0.000530908914193105947905426678090634596,
            -0.00023441338636570594237094888878658594 ,
            -0.000073533826131665439018725294317846419,
            0.000336129189338528206864448177881854463,
            -0.000510687277928748278171822150284242525,
            0.000574998211069439771163380736851422625,
            -0.000529258201768758609027931694157587117,
            0.000393667682266056419195660032173123   ,
            -0.000202590877056878752729765502671455124,
            -0.000003278367075042088985513660109871736,
            0.000185076639727297612581652375141061384,
            -0.000312703110865392229066744844701020156,
            0.000369365162239951750223349025148422697,
            -0.000353151311061978049297971349318459033,
            0.000275667582450218916819556502773025386,
            -0.000158322051289122627199326687197356023,
            0.000027220299951538816726629224640454652,
            0.000092211836657987033714564684139247674,
            -0.000179837642227859779899684644632884556,
            0.000223875855225321828811252400370790383,
            -0.000222031901071524472154536389290058196,
            0.000180715773134834168690832090220510509,
            -0.000112729639074087917630095923016142478,
            0.000034053340593552446644368125738822073,
            0.00003954909434114758215840848554201159 ,
            -0.000095434744204673249983079952318831829,
            0.000126009690458823341236219151006991979,
            -0.000129440946180701287786599107398899378,
            0.000109179278800662291071255083352298243,
            -0.000072546170807492613781704282605033995,
            0.000028785854511730010919920083600764826,
            0.000012966839022527635013671588881667418,
            -0.000045397517611404454758190080143620548,
            0.000064116209784480525423269736684517284,
            -0.000068028167296151656430122645069502596,
            0.000059008308070323965872656241105076447,
            -0.000041049015408569425854019147026363612,
            0.000019131083971454911828126085882040286,
            0.000001914174485137727038615079386274509,
            -0.000018322460239788132595282338366260433,
            0.000135450061907561012958939317130102609 };
        return (new FilterFIR(coef, order, maxBufSize));
    };
    
    Filter * FilterCreator::createEquiripple19k250(int maxBufSize)
    {
        int order = 251;
        float coef[] = {
            0.00015001720607993977176473909818099628 ,
            -0.000075209970253477988612160476389334463,
            0.000046145647300449175662317990997962625,
            0.000032533291860033030458085323566308489,
            -0.000169969384736525555004357790345181911,
            0.000366867274859743468413963984886549952,
            -0.000612724438357130254777238587138299408,
            0.000884864459164386271856905796795444985,
            -0.00114988594601237001553706296164136802 ,
            0.001367705626133618353190701810717655462,
            -0.001497835776056960759711200736887803941,
            0.001506911320418071516952229771391102986,
            -0.001376125225076557830050649755548874964,
            0.001107050429387490455418463497494485637,
            -0.000724392044486350935791896255011579342,
            0.000274621503565943730126169830541016381,
            0.000179860197044701629852381241647663046,
            -0.000570390463316469979900003028916444237,
            0.000834044233797121567844379264045073796,
            -0.000925805598717438288022818504430233588,
            0.00082852919306644048826754334058364293 ,
            -0.00055851935758161302524732461094458813 ,
            0.000165011081183982181042751991029149394,
            0.00027700750355359998050586156637109525 ,
            -0.000679732947735028859501116293984068761,
            0.000958929186325291208273235987746829778,
            -0.001050828910797786544875642711360796966,
            0.000926388950041511275400318847772496156,
            -0.000599532723397645773109887468166334656,
            0.000126877120105783105499450136299799397,
            0.000401294582440964772013236583347861597,
            -0.000877224828935484397286759250533805243,
            0.001197177737888996873136249199376379693,
            -0.001283928364582053284828622174984502635,
            0.001103739090521374966585854693335022603,
            -0.000677597820512709368874493254253366104,
            0.000079565243258607377821803319228877172,
            0.000574728878840740243366669304236893367,
            -0.001150067701531336120460147220967428439,
            0.001518920196788960553374581152752398339,
            -0.001589099472226512517816776615120488714,
            0.001325782216473639970460984827127504104,
            -0.000762830424573619466158125312915672112,
            0.000000249724506375967778666684045510427,
            0.000812677497045769057365527388014925236,
            -0.001505959554081505360340065280411181448,
            0.001923819878255035543609952064514345693,
            -0.00195893117576374092836388740579423029 ,
            0.001578607272454687817514473735514002328,
            -0.000836800357911760190644800960768634468,
            -0.000131696361102625198987239873993360106,
            0.001134772356738548678214972831312934431,
            -0.001960320570546247170851117402889940422,
            0.002420337020631839822226716307795868488,
            -0.002392781082712257690464641157745973032,
            0.001852072724723575819147369792005974887,
            -0.000880810655909994061514567409432174827,
            -0.000340880880933619456740757414081599563,
            0.001567577244588395880484088529271957668,
            -0.002536968603684096757594490512133234006,
            0.003025050365223156886851363367441081209,
            -0.002896557562462531969921242236409852921,
            0.002139655267019521800442305448086699471,
            -0.000876505352196609737770727210914856187,
            -0.000654427476263903058414928004538069217,
            0.002142068152630548834997048501804783882,
            -0.003264641174497601681936398421157718985,
            0.00375823789367620269413761135979257233 ,
            -0.003476843213340373005965089348023866478,
            0.002431417358827245214086820723764503782,
            -0.000797443955427167504822205668091328334,
            -0.001112045262045716596810418508312068298,
            0.002904808597786784525596193162755298545,
            -0.004188383543416293250394311087347887224,
            0.004654203908858203092568928127548133489,
            -0.004149175357542208252004112267741220421,
            0.002718587597661414889671505079604685307,
            -0.000609320665853490183935803337078596087,
            -0.001769892162519815653753951778526243288,
            0.003925397904157894996002298171333677601,
            -0.005378761697714280580473467097135653603,
            0.005770276175246060249013346776791877346,
            -0.004943932728684419068698741028811127762,
            0.002994513967224104056957800779059652996,
            -0.000264329160956247837931804012256975511,
            -0.002713097100036359222291482140576590609,
            0.00531393827984276336667823770198992861 ,
            -0.006951215095817369835073940009806392482,
            0.007202811046320241848694987396584110684,
            -0.005913440675006092529797374623967698426,
            0.003247076639903874028386665528955745685,
            0.000324718933073102821937339079738649161,
            -0.004100588744058728321584261777843494201,
            0.007281578719043869940552582420423277654,
            -0.009133870894334931295199808687357290182,
            0.009150078399594948133644045640266995179,
            -0.007175032383136070203433209968579831184,
            0.003467230792278448974624849299175366468,
            0.001321859939415008337870727217477906379,
            -0.006252754921442120646102313941128159058,
            0.010271716281673124240847450039382238174,
            -0.012423207397197532156352117738151719095,
            0.012059996455136917647976702028245199472,
            -0.009008015859682302201028036847674229648,
            0.003648227234111241657626978351913749066,
            0.003107927204125705833437365299687371589,
            -0.009953766342846569886715357711182150524,
            0.015415886396543988789975543340915464796,
            -0.018138928361382110343580364997251308523,
            0.017175765558524739434753669797828479204,
            -0.012227461785692365567324024766548973275,
            0.003782910154900840423580765659039570892,
            0.006876585880256356683726259859668061836,
            -0.017819655004149774490951330108146066777,
            0.026739503371764967304402560444032133091,
            -0.031321070181210275418237642952590249479,
            0.02964172514701033864237267323460400803 ,
            -0.020537066064751162419721453034071600996,
            0.003865979798404863346239501709078467684,
            0.019376511332403999199325284052974893712,
            -0.047125598570399454545487571976991603151,
            0.076489746129288396780943060093704843894,
            -0.104137121864812998150995326795964501798,
            0.126766996028961465015072462847456336021,
            -0.141591605604337006374393581609183456749,
            0.146750783851158611570397738432802725583,
            -0.141591605604337006374393581609183456749,
            0.126766996028961465015072462847456336021,
            -0.104137121864812998150995326795964501798,
            0.076489746129288396780943060093704843894,
            -0.047125598570399454545487571976991603151,
            0.019376511332403999199325284052974893712,
            0.003865979798404863346239501709078467684,
            -0.020537066064751162419721453034071600996,
            0.02964172514701033864237267323460400803 ,
            -0.031321070181210275418237642952590249479,
            0.026739503371764967304402560444032133091,
            -0.017819655004149774490951330108146066777,
            0.006876585880256356683726259859668061836,
            0.003782910154900840423580765659039570892,
            -0.012227461785692365567324024766548973275,
            0.017175765558524739434753669797828479204,
            -0.018138928361382110343580364997251308523,
            0.015415886396543988789975543340915464796,
            -0.009953766342846569886715357711182150524,
            0.003107927204125705833437365299687371589,
            0.003648227234111241657626978351913749066,
            -0.009008015859682302201028036847674229648,
            0.012059996455136917647976702028245199472,
            -0.012423207397197532156352117738151719095,
            0.010271716281673124240847450039382238174,
            -0.006252754921442120646102313941128159058,
            0.001321859939415008337870727217477906379,
            0.003467230792278448974624849299175366468,
            -0.007175032383136070203433209968579831184,
            0.009150078399594948133644045640266995179,
            -0.009133870894334931295199808687357290182,
            0.007281578719043869940552582420423277654,
            -0.004100588744058728321584261777843494201,
            0.000324718933073102821937339079738649161,
            0.003247076639903874028386665528955745685,
            -0.005913440675006092529797374623967698426,
            0.007202811046320241848694987396584110684,
            -0.006951215095817369835073940009806392482,
            0.00531393827984276336667823770198992861 ,
            -0.002713097100036359222291482140576590609,
            -0.000264329160956247837931804012256975511,
            0.002994513967224104056957800779059652996,
            -0.004943932728684419068698741028811127762,
            0.005770276175246060249013346776791877346,
            -0.005378761697714280580473467097135653603,
            0.003925397904157894996002298171333677601,
            -0.001769892162519815653753951778526243288,
            -0.000609320665853490183935803337078596087,
            0.002718587597661414889671505079604685307,
            -0.004149175357542208252004112267741220421,
            0.004654203908858203092568928127548133489,
            -0.004188383543416293250394311087347887224,
            0.002904808597786784525596193162755298545,
            -0.001112045262045716596810418508312068298,
            -0.000797443955427167504822205668091328334,
            0.002431417358827245214086820723764503782,
            -0.003476843213340373005965089348023866478,
            0.00375823789367620269413761135979257233 ,
            -0.003264641174497601681936398421157718985,
            0.002142068152630548834997048501804783882,
            -0.000654427476263903058414928004538069217,
            -0.000876505352196609737770727210914856187,
            0.002139655267019521800442305448086699471,
            -0.002896557562462531969921242236409852921,
            0.003025050365223156886851363367441081209,
            -0.002536968603684096757594490512133234006,
            0.001567577244588395880484088529271957668,
            -0.000340880880933619456740757414081599563,
            -0.000880810655909994061514567409432174827,
            0.001852072724723575819147369792005974887,
            -0.002392781082712257690464641157745973032,
            0.002420337020631839822226716307795868488,
            -0.001960320570546247170851117402889940422,
            0.001134772356738548678214972831312934431,
            -0.000131696361102625198987239873993360106,
            -0.000836800357911760190644800960768634468,
            0.001578607272454687817514473735514002328,
            -0.00195893117576374092836388740579423029 ,
            0.001923819878255035543609952064514345693,
            -0.001505959554081505360340065280411181448,
            0.000812677497045769057365527388014925236,
            0.000000249724506375967778666684045510427,
            -0.000762830424573619466158125312915672112,
            0.001325782216473639970460984827127504104,
            -0.001589099472226512517816776615120488714,
            0.001518920196788960553374581152752398339,
            -0.001150067701531336120460147220967428439,
            0.000574728878840740243366669304236893367,
            0.000079565243258607377821803319228877172,
            -0.000677597820512709368874493254253366104,
            0.001103739090521374966585854693335022603,
            -0.001283928364582053284828622174984502635,
            0.001197177737888996873136249199376379693,
            -0.000877224828935484397286759250533805243,
            0.000401294582440964772013236583347861597,
            0.000126877120105783105499450136299799397,
            -0.000599532723397645773109887468166334656,
            0.000926388950041511275400318847772496156,
            -0.001050828910797786544875642711360796966,
            0.000958929186325291208273235987746829778,
            -0.000679732947735028859501116293984068761,
            0.00027700750355359998050586156637109525 ,
            0.000165011081183982181042751991029149394,
            -0.00055851935758161302524732461094458813 ,
            0.00082852919306644048826754334058364293 ,
            -0.000925805598717438288022818504430233588,
            0.000834044233797121567844379264045073796,
            -0.000570390463316469979900003028916444237,
            0.000179860197044701629852381241647663046,
            0.000274621503565943730126169830541016381,
            -0.000724392044486350935791896255011579342,
            0.001107050429387490455418463497494485637,
            -0.001376125225076557830050649755548874964,
            0.001506911320418071516952229771391102986,
            -0.001497835776056960759711200736887803941,
            0.001367705626133618353190701810717655462,
            -0.00114988594601237001553706296164136802 ,
            0.000884864459164386271856905796795444985,
            -0.000612724438357130254777238587138299408,
            0.000366867274859743468413963984886549952,
            -0.000169969384736525555004357790345181911,
            0.000032533291860033030458085323566308489,
            0.000046145647300449175662317990997962625,
            -0.000075209970253477988612160476389334463,
            0.00015001720607993977176473909818099628  };
        return (new FilterFIR(coef, order, maxBufSize));
    };

    
};
